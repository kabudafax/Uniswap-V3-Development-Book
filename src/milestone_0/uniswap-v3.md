# Uniswap V3 ç®€ä»‹

> æœ¬ç« é‡è¿°äº† [Uniswap V3 çš„ç™½çš®ä¹¦](https://uniswap.org/whitepaper-v3.pdf)ã€‚å†æ¬¡å¼ºè°ƒï¼Œå¦‚æœä½ ä¸ç†è§£æ‰€æœ‰æ¦‚å¿µä¹Ÿæ²¡å…³ç³»ã€‚å½“è¿™äº›æ¦‚å¿µè½¬åŒ–ä¸ºä»£ç æ—¶ï¼Œå®ƒä»¬ä¼šå˜å¾—æ›´åŠ æ¸…æ™°ã€‚

ä¸ºäº†æ›´å¥½åœ°ç†è§£ Uniswap V3 å¸¦æ¥çš„åˆ›æ–°ï¼Œè®©æˆ‘ä»¬é¦–å…ˆçœ‹çœ‹ Uniswap V2 çš„ä¸è¶³ä¹‹å¤„ã€‚

Uniswap V2 æ˜¯ä¸€ä¸ªå®ç°äº†å•ä¸€ AMM ç®—æ³•çš„é€šç”¨äº¤æ˜“æ‰€ã€‚ç„¶è€Œï¼Œå¹¶éæ‰€æœ‰äº¤æ˜“å¯¹éƒ½æ˜¯å¹³ç­‰çš„ã€‚äº¤æ˜“å¯¹å¯ä»¥æŒ‰ä»·æ ¼æ³¢åŠ¨æ€§åˆ†ç»„ï¼š

1. ä¸­ç­‰å’Œé«˜ä»·æ ¼æ³¢åŠ¨æ€§çš„ä»£å¸ã€‚è¿™ä¸ªç»„åŒ…æ‹¬å¤§å¤šæ•°ä»£å¸ï¼Œå› ä¸ºå¤§å¤šæ•°ä»£å¸çš„ä»·æ ¼æ²¡æœ‰ä¸æŸç‰©æŒ‚é’©ï¼Œå®¹æ˜“å—åˆ°å¸‚åœºæ³¢åŠ¨çš„å½±å“ã€‚
2. ä½æ³¢åŠ¨æ€§çš„ä»£å¸ã€‚è¿™ä¸ªç»„åŒ…æ‹¬é”šå®šä»£å¸ï¼Œä¸»è¦æ˜¯ç¨³å®šå¸ï¼šUSDC/USDTã€USDC/DAIã€USDT/DAI ç­‰ã€‚è¿˜åŒ…æ‹¬ï¼šETH/stETHã€ETH/rETHï¼ˆåŒ…è£… ETH çš„å˜ä½“ï¼‰ã€‚

è¿™äº›ç»„éœ€è¦ä¸åŒçš„ã€æˆ‘ä»¬ç§°ä¹‹ä¸ºæ± é…ç½®ã€‚ä¸»è¦åŒºåˆ«åœ¨äºï¼Œé”šå®šä»£å¸éœ€è¦é«˜æµåŠ¨æ€§æ¥å‡å°‘å¤§é¢äº¤æ˜“çš„éœ€æ±‚æ•ˆåº”ï¼ˆæˆ‘ä»¬åœ¨ä¸Šä¸€ç« ä¸­äº†è§£åˆ°è¿™ä¸€ç‚¹ï¼‰ã€‚æ— è®ºæˆ‘ä»¬æƒ³ä¹°å–å¤šå°‘ä»£å¸ï¼ŒUSDC å’Œ USDT çš„ä»·æ ¼å¿…é¡»ä¿æŒæ¥è¿‘ 1ã€‚ç”±äº Uniswap V2 çš„é€šç”¨ AMM ç®—æ³•ä¸å¤ªé€‚åˆç¨³å®šå¸äº¤æ˜“ï¼Œå…¶ä»– AMMï¼ˆä¸»è¦æ˜¯ [Curve](https://curve.fi)ï¼‰åœ¨ç¨³å®šå¸äº¤æ˜“ä¸­æ›´å—æ¬¢è¿ã€‚

é€ æˆè¿™ä¸ªé—®é¢˜çš„åŸå› æ˜¯ Uniswap V2 æ± ä¸­çš„æµåŠ¨æ€§æ˜¯æ— é™åˆ†å¸ƒçš„â€”â€”poolæµåŠ¨æ€§å…è®¸åœ¨ä»»ä½•ä»·æ ¼ä¸‹è¿›è¡Œäº¤æ˜“ï¼Œä» 0 åˆ°æ— ç©·å¤§ï¼š

![æ›²çº¿æ˜¯æ— é™çš„](images/curve_infinite.png)

è¿™å¯èƒ½çœ‹èµ·æ¥ä¸æ˜¯åäº‹ï¼Œä½†è¿™ä½¿å¾—èµ„æœ¬æ•ˆç‡ä½ä¸‹ã€‚èµ„äº§çš„å†å²ä»·æ ¼é€šå¸¸ä¿æŒåœ¨æŸä¸ªå®šä¹‰çš„èŒƒå›´å†…ï¼Œæ— è®ºè¿™ä¸ªèŒƒå›´æ˜¯çª„è¿˜æ˜¯å®½ã€‚ä¾‹å¦‚ï¼ŒETH çš„å†å²ä»·æ ¼èŒƒå›´æ˜¯ä» $0.75 åˆ° $4,800ï¼ˆæ ¹æ® [CoinMarketCap](https://coinmarketcap.com/currencies/ethereum/)ï¼‰ã€‚ä»Šå¤©ï¼ˆ2022 å¹´ 6 æœˆï¼Œ1 ETH ä»·å€¼ $1,800ï¼‰ï¼Œæ²¡æœ‰äººä¼šä»¥ $5000 çš„ä»·æ ¼è´­ä¹° 1 ä¸ªä»¥å¤ªå¸ï¼Œæ‰€ä»¥åœ¨è¿™ä¸ªä»·æ ¼æä¾›æµåŠ¨æ€§æ˜¯æ²¡æœ‰æ„ä¹‰çš„ã€‚å› æ­¤ï¼Œåœ¨è¿œç¦»å½“å‰ä»·æ ¼æˆ–æ°¸è¿œä¸ä¼šè¾¾åˆ°çš„ä»·æ ¼èŒƒå›´å†…æä¾›æµåŠ¨æ€§æ˜¯æ²¡æœ‰æ„ä¹‰çš„ã€‚

> å½“ç„¶ï¼Œæˆ‘ä»¬éƒ½ç›¸ä¿¡ ETH æœ‰æœä¸€æ—¥ä¼šè¾¾åˆ° `$10,000`ï¼Œä½†è¿™æ˜¯å¦ä¸€ä¸ªæ•…äº‹äº†ã€‚


## é›†ä¸­æµåŠ¨æ€§

Uniswap V3å¼•å…¥äº†*é›†ä¸­æµåŠ¨æ€§*ï¼šæµåŠ¨æ€§æä¾›è€…ç°åœ¨å¯ä»¥é€‰æ‹©ä»–ä»¬æƒ³è¦æä¾›æµåŠ¨æ€§çš„ä»·æ ¼èŒƒå›´ã€‚è¿™é€šè¿‡å…è®¸åœ¨ç‹­çª„çš„ä»·æ ¼èŒƒå›´å†…æŠ•å…¥æ›´å¤šæµåŠ¨æ€§æ¥æé«˜èµ„æœ¬æ•ˆç‡ï¼Œä½¿Uniswapå˜å¾—æ›´åŠ å¤šæ ·åŒ–ï¼šå®ƒç°åœ¨å¯ä»¥ä¸ºå…·æœ‰ä¸åŒæ³¢åŠ¨æ€§çš„äº¤æ˜“å¯¹é…ç½®æ± ã€‚è¿™å°±æ˜¯V3å¦‚ä½•æ”¹è¿›V2çš„æ–¹å¼ã€‚

ç®€è€Œè¨€ä¹‹ï¼Œä¸€ä¸ªUniswap V3äº¤æ˜“å¯¹å°±æ˜¯è®¸å¤šå°çš„Uniswap V2äº¤æ˜“å¯¹ã€‚V2å’ŒV3ä¹‹é—´çš„ä¸»è¦åŒºåˆ«åœ¨äºï¼Œåœ¨V3ä¸­ï¼Œä¸€ä¸ªäº¤æ˜“å¯¹ä¸­æœ‰**å¤šä¸ªä»·æ ¼èŒƒå›´**ã€‚è€Œä¸”è¿™äº›è¾ƒçŸ­çš„ä»·æ ¼èŒƒå›´æ¯ä¸ªéƒ½æœ‰**æœ‰é™çš„å‚¨å¤‡**ã€‚æ•´ä¸ªä»0åˆ°æ— ç©·çš„ä»·æ ¼èŒƒå›´è¢«åˆ†å‰²æˆè¾ƒçŸ­çš„ä»·æ ¼èŒƒå›´ï¼Œæ¯ä¸ªèŒƒå›´éƒ½æœ‰è‡ªå·±çš„æµåŠ¨æ€§æ•°é‡ã€‚ä½†æ˜¯ï¼Œå…³é”®æ˜¯åœ¨é‚£ä¸ªè¾ƒçŸ­çš„ä»·æ ¼èŒƒå›´å†…ï¼Œ**å®ƒçš„å·¥ä½œæ–¹å¼ä¸Uniswap V2å®Œå…¨ç›¸åŒ**ã€‚è¿™å°±æ˜¯ä¸ºä»€ä¹ˆæˆ‘è¯´V3äº¤æ˜“å¯¹æ˜¯è®¸å¤šå°çš„V2äº¤æ˜“å¯¹ã€‚

ç°åœ¨ï¼Œè®©æˆ‘ä»¬è¯•ç€å°†å…¶å¯è§†åŒ–ã€‚æˆ‘ä»¬ä¸å¸Œæœ›æ›²çº¿æ˜¯æ— é™çš„ï¼Œæ‰€ä»¥åœ¨ç‚¹ a å’Œ b å¤„åˆ‡æ–­å®ƒï¼Œå¹¶å°†å…¶ä½œä¸ºæ›²çº¿çš„è¾¹ç•Œã€‚æ­¤å¤–ï¼Œæˆ‘ä»¬ç§»åŠ¨æ›²çº¿ä½¿è¾¹ç•Œè½åœ¨åæ ‡è½´ä¸Šã€‚è¿™å°±æ˜¯æˆ‘ä»¬å¾—åˆ°çš„ç»“æœï¼š

![Uniswap V3ä»·æ ¼èŒƒå›´](images/curve_finite.png)

> çœ‹èµ·æ¥æœ‰ç‚¹å­¤å•ï¼Œä¸æ˜¯å—ï¼Ÿè¿™å°±æ˜¯ä¸ºä»€ä¹ˆUniswap V3ä¸­æœ‰è®¸å¤šä»·æ ¼èŒƒå›´â€”â€”è¿™æ ·å®ƒä»¬å°±ä¸ä¼šæ„Ÿåˆ°å­¤å•äº†ğŸ™‚

æ­£å¦‚æˆ‘ä»¬åœ¨ä¸Šä¸€ç« çœ‹åˆ°çš„ï¼Œä¹°å…¥æˆ–å–å‡ºä»£å¸ä¼šä½¿ä»·æ ¼æ²¿æ›²çº¿ç§»åŠ¨ã€‚ä»·æ ¼èŒƒå›´é™åˆ¶äº†ä»·æ ¼çš„ç§»åŠ¨ã€‚å½“ä»·æ ¼ç§»åŠ¨åˆ°ä»»ä¸€ç‚¹æ—¶ï¼Œæ± å­å˜å¾—**è€—å°½**ï¼šå…¶ä¸­ä¸€ç§ä»£å¸çš„å‚¨å¤‡å°†ä¸º0ï¼Œä¹°å…¥è¿™ç§ä»£å¸å°†ä¸å†å¯èƒ½ã€‚

åœ¨ä¸Šé¢çš„å›¾è¡¨ä¸­ï¼Œå‡è®¾èµ·å§‹ä»·æ ¼åœ¨æ›²çº¿çš„ä¸­é—´ã€‚è¦åˆ°è¾¾ç‚¹$a$ï¼Œæˆ‘ä»¬éœ€è¦ä¹°å…¥æ‰€æœ‰å¯ç”¨çš„$y$å¹¶åœ¨èŒƒå›´å†…æœ€å¤§åŒ–$x$ï¼›è¦åˆ°è¾¾ç‚¹$b$ï¼Œæˆ‘ä»¬éœ€è¦ä¹°å…¥æ‰€æœ‰å¯ç”¨çš„$x$å¹¶åœ¨èŒƒå›´å†…æœ€å¤§åŒ–$y$ã€‚åœ¨è¿™äº›ç‚¹ä¸Šï¼ŒèŒƒå›´å†…åªæœ‰ä¸€ç§ä»£å¸ï¼

> æœ‰è¶£çš„äº‹å®ï¼šè¿™å…è®¸ä½¿ç”¨Uniswap V3ä»·æ ¼èŒƒå›´ä½œä¸ºé™ä»·è®¢å•ï¼

å½“å½“å‰ä»·æ ¼èŒƒå›´åœ¨äº¤æ˜“è¿‡ç¨‹ä¸­è€—å°½æ—¶ä¼šå‘ç”Ÿä»€ä¹ˆï¼Ÿä»·æ ¼ä¼šæ»‘å…¥ä¸‹ä¸€ä¸ªä»·æ ¼èŒƒå›´ã€‚å¦‚æœä¸‹ä¸€ä¸ªä»·æ ¼èŒƒå›´ä¸å­˜åœ¨ï¼Œäº¤æ˜“æœ€ç»ˆä¼šéƒ¨åˆ†å®Œæˆâ€”â€”æˆ‘ä»¬å°†åœ¨æœ¬ä¹¦åé¢çœ‹åˆ°è¿™æ˜¯å¦‚ä½•å·¥ä½œçš„ã€‚

è¿™å°±æ˜¯[ç”Ÿäº§ç¯å¢ƒä¸­çš„USDC/ETHæ± ](https://info.uniswap.org/#/pools/0x8ad599c3a0ff1de082011efddc58f1908eb6e6d8)ä¸­æµåŠ¨æ€§çš„åˆ†å¸ƒæƒ…å†µï¼š

![çœŸå®USDC/ETHæ± ä¸­çš„æµåŠ¨æ€§](images/usdceth_liquidity.png)

ä½ å¯ä»¥çœ‹åˆ°ï¼Œåœ¨å½“å‰ä»·æ ¼é™„è¿‘æœ‰å¤§é‡æµåŠ¨æ€§ï¼Œä½†ç¦»å®ƒè¶Šè¿œæµåŠ¨æ€§å°±è¶Šå°‘â€”â€”è¿™æ˜¯å› ä¸ºæµåŠ¨æ€§æä¾›è€…åŠªåŠ›æé«˜ä»–ä»¬çš„èµ„æœ¬æ•ˆç‡ã€‚æ­¤å¤–ï¼Œæ•´ä¸ªèŒƒå›´å¹¶éæ— é™ï¼Œå…¶ä¸Šé™åœ¨å›¾ä¸­æ˜¾ç¤ºã€‚


## Uniswap V3 çš„æ•°å­¦åŸç†

ä»æ•°å­¦è§’åº¦æ¥çœ‹ï¼ŒUniswap V3 æ˜¯åŸºäº V2 çš„ï¼šå®ƒä½¿ç”¨ç›¸åŒçš„å…¬å¼ï¼Œä½†è¿™äº›å…¬å¼è¢«...æˆ‘ä»¬ç§°ä¹‹ä¸º*å¢å¼º*äº†ã€‚

ä¸ºäº†å¤„ç†ä»·æ ¼èŒƒå›´ä¹‹é—´çš„è½¬æ¢ã€ç®€åŒ–æµåŠ¨æ€§ç®¡ç†å¹¶é¿å…èˆå…¥è¯¯å·®ï¼ŒUniswap V3 ä½¿ç”¨äº†è¿™äº›æ–°æ¦‚å¿µï¼š

$$L = \sqrt{xy}$$

$$\sqrt{P} = \sqrt{\frac{y}{x}}$$

$L$ æ˜¯*æµåŠ¨æ€§æ•°é‡*ã€‚æ± ä¸­çš„æµåŠ¨æ€§æ˜¯ä»£å¸å‚¨å¤‡çš„ç»„åˆï¼ˆå³ä¸¤ä¸ªæ•°å­—ï¼‰ã€‚æˆ‘ä»¬çŸ¥é“å®ƒä»¬çš„ä¹˜ç§¯æ˜¯ $k$ï¼Œæˆ‘ä»¬å¯ä»¥ç”¨è¿™ä¸ªæ¥æ¨å¯¼æµåŠ¨æ€§çš„åº¦é‡ï¼Œå³ $\sqrt{xy}$â€”â€”ä¸€ä¸ªä¸è‡ªèº«ç›¸ä¹˜ç­‰äº $k$ çš„æ•°ã€‚$L$ æ˜¯ $x$ å’Œ $y$ çš„å‡ ä½•å¹³å‡æ•°ã€‚

$y/x$ æ˜¯ä»¥ä»£å¸ 1 è¡¨ç¤ºçš„ä»£å¸ 0 çš„ä»·æ ¼ã€‚ç”±äºæ± ä¸­ä»£å¸ä»·æ ¼æ˜¯å½¼æ­¤çš„å€’æ•°ï¼Œæˆ‘ä»¬å¯ä»¥åœ¨è®¡ç®—ä¸­åªä½¿ç”¨å…¶ä¸­ä¸€ä¸ªï¼ˆæŒ‰æƒ¯ä¾‹ï¼ŒUniswap V3 ä½¿ç”¨ $y/x$ï¼‰ã€‚ä»¥ä»£å¸ 0 è¡¨ç¤ºçš„ä»£å¸ 1 çš„ä»·æ ¼ç®€å•åœ°æ˜¯ $\frac{1}{y/x}=\frac{x}{y}$ã€‚åŒæ ·ï¼Œ$\frac{1}{\sqrt{P}} = \frac{1}{\sqrt{y/x}} = \sqrt{\frac{x}{y}}$ã€‚

ä¸ºä»€ä¹ˆä½¿ç”¨ $\sqrt{p}$ è€Œä¸æ˜¯ $p$ï¼Ÿæœ‰ä¸¤ä¸ªåŸå› ï¼š

1. å¹³æ–¹æ ¹è®¡ç®—ä¸ç²¾ç¡®å¹¶ä¼šå¯¼è‡´èˆå…¥è¯¯å·®ã€‚å› æ­¤ï¼Œåœ¨åˆçº¦ä¸­å­˜å‚¨å¹³æ–¹æ ¹è€Œä¸è¿›è¡Œè®¡ç®—æ›´å®¹æ˜“ï¼ˆæˆ‘ä»¬ä¸ä¼šåœ¨åˆçº¦ä¸­å­˜å‚¨ $x$ å’Œ $y$ï¼‰ã€‚

2. $\sqrt{P}$ ä¸ $L$ æœ‰ä¸€ä¸ªæœ‰è¶£çš„è”ç³»ï¼š$L$ ä¹Ÿæ˜¯è¾“å‡ºé‡å˜åŒ–ä¸ $\sqrt{P}$ å˜åŒ–ä¹‹é—´çš„å…³ç³»ã€‚

$$L = \frac{\Delta y}{\Delta\sqrt{P}}$$

> è¯æ˜ï¼š

$$L = \frac{\Delta y}{\Delta\sqrt{P}}$$

$$\sqrt{xy} = \frac{y_1 - y_0}{\sqrt{P_1} - \sqrt{P_0}}$$

$$\sqrt{xy} (\sqrt{P_1} - \sqrt{P_0}) = y_1 - y_0$$

$$\sqrt{xy} (\sqrt{\frac{y_1}{x_1}} - \sqrt{\frac{y_0}{x_0}}) = y_1 - y_0$$

$$\textrm{ç”±äº } \sqrt{x_1y_1} = \sqrt{x_0y_0} = \sqrt{xy} = L,$$

$$\sqrt{\frac{x_1y_1y_1}{x_1}} - \sqrt{\frac{x_0y_0y_0}{x_0}} = y_1 - y_0$$

$$\sqrt{y_1^2} - \sqrt{y_0^2} = y_1 - y_0$$

$$y_1 - y_0 = y_1 - y_0$$

## å®šä»·

å†æ¬¡å¼ºè°ƒï¼Œæˆ‘ä»¬ä¸éœ€è¦è®¡ç®—å®é™…ä»·æ ¼â€”â€”æˆ‘ä»¬å¯ä»¥ç›´æ¥è®¡ç®—è¾“å‡ºé‡ã€‚æ­¤å¤–ï¼Œç”±äºæˆ‘ä»¬ä¸æ‰“ç®—è·Ÿè¸ªå’Œå­˜å‚¨ $x$ å’Œ $y$ï¼Œæˆ‘ä»¬çš„è®¡ç®—å°†ä»…åŸºäº $L$ å’Œ $\sqrt{P}$ã€‚

ä»ä¸Šé¢çš„å…¬å¼ä¸­ï¼Œæˆ‘ä»¬å¯ä»¥æ‰¾åˆ° $\Delta y$ï¼š

$$\Delta y = \Delta \sqrt{P} L$$

> è§ä¸Šé¢è¯æ˜çš„ç¬¬ä¸‰æ­¥ã€‚

å¦‚æˆ‘ä»¬ä¹‹å‰è®¨è®ºçš„ï¼Œæ± ä¸­çš„ä»·æ ¼æ˜¯å½¼æ­¤çš„å€’æ•°ã€‚å› æ­¤ï¼Œ$\Delta x$ æ˜¯ï¼š

$$\Delta x = \Delta \frac{1}{\sqrt{P}} L$$

$L$ å’Œ $\sqrt{P}$ ä½¿æˆ‘ä»¬ä¸éœ€è¦å­˜å‚¨å’Œæ›´æ–°æ± å‚¨å¤‡ã€‚æ­¤å¤–ï¼Œæˆ‘ä»¬ä¸éœ€è¦æ¯æ¬¡éƒ½è®¡ç®— $\sqrt{P}$ï¼Œå› ä¸ºæˆ‘ä»¬æ€»æ˜¯å¯ä»¥æ‰¾åˆ° $\Delta \sqrt{P}$ åŠå…¶å€’æ•°ã€‚

## Ticks

æ­£å¦‚æˆ‘ä»¬åœ¨æœ¬ç« ä¸­äº†è§£åˆ°çš„ï¼ŒV2 çš„æ— é™ä»·æ ¼èŒƒå›´åœ¨ V3 ä¸­è¢«åˆ†å‰²æˆè¾ƒçŸ­çš„ä»·æ ¼èŒƒå›´ã€‚è¿™äº›è¾ƒçŸ­çš„ä»·æ ¼èŒƒå›´ä¸­çš„æ¯ä¸€ä¸ªéƒ½ç”±è¾¹ç•Œé™åˆ¶â€”â€”ä¸Šé™å’Œä¸‹é™ã€‚ä¸ºäº†è·Ÿè¸ªè¿™äº›è¾¹ç•Œçš„åæ ‡ï¼ŒUniswap V3 ä½¿ç”¨äº† *ticks*ã€‚

![ä»·æ ¼èŒƒå›´å’Œ ticks](images/ticks_and_ranges.png)

åœ¨ V3 ä¸­ï¼Œæ•´ä¸ªä»·æ ¼èŒƒå›´ç”±å‡åŒ€åˆ†å¸ƒçš„ç¦»æ•£ ticks åˆ’åˆ†ã€‚æ¯ä¸ª tick éƒ½æœ‰ä¸€ä¸ªç´¢å¼•ï¼Œå¯¹åº”äºæŸä¸ªç‰¹å®šä»·æ ¼ï¼š

$$p(i) = 1.0001^i$$

å…¶ä¸­ $p(i)$ æ˜¯ tick $i$ å¤„çš„ä»·æ ¼ã€‚å– 1.0001 çš„å¹‚å…·æœ‰ä¸€ä¸ªç†æƒ³çš„ç‰¹æ€§ï¼šä¸¤ä¸ªç›¸é‚» ticks ä¹‹é—´çš„å·®å¼‚æ˜¯ 0.01% æˆ– *1 ä¸ªåŸºç‚¹*ã€‚

> åŸºç‚¹ï¼ˆ1% çš„ 1/100ï¼Œæˆ– 0.01%ï¼Œæˆ– 0.0001ï¼‰æ˜¯é‡‘èé¢†åŸŸä¸­ç™¾åˆ†æ¯”çš„åº¦é‡å•ä½ã€‚ä½ å¯èƒ½åœ¨ä¸­å¤®é“¶è¡Œå®£å¸ƒåˆ©ç‡å˜åŒ–æ—¶å¬è¯´è¿‡åŸºç‚¹ã€‚

å¦‚æˆ‘ä»¬ä¹‹å‰è®¨è®ºçš„ï¼ŒUniswap V3 å­˜å‚¨ $\sqrt{P}$ï¼Œè€Œä¸æ˜¯ $P$ã€‚å› æ­¤ï¼Œå…¬å¼å®é™…ä¸Šæ˜¯ï¼š

$$\sqrt{p(i)} = \sqrt{1.0001}^i = 1.0001 ^{\frac{i}{2}}$$

æ‰€ä»¥ï¼Œæˆ‘ä»¬å¾—åˆ°çš„å€¼å¦‚ï¼š$\sqrt{p(0)} = 1$ï¼Œ$\sqrt{p(1)} = \sqrt{1.0001} \approx 1.00005$ï¼Œ$\sqrt{p(-1)} \approx 0.99995$ã€‚

Ticks æ˜¯å¯ä»¥ä¸ºæ­£ä¹Ÿå¯ä»¥ä¸ºè´Ÿçš„æ•´æ•°ï¼Œå½“ç„¶ï¼Œå®ƒä»¬ä¸æ˜¯æ— é™çš„ã€‚Uniswap V3 å°† $\sqrt{P}$ å­˜å‚¨ä¸º Q64.96 å®šç‚¹æ•°ï¼Œè¿™æ˜¯ä¸€ä¸ªæœ‰ç†æ•°ï¼Œä½¿ç”¨ 64 ä½è¡¨ç¤ºæ•´æ•°éƒ¨åˆ†ï¼Œ96 ä½è¡¨ç¤ºå°æ•°éƒ¨åˆ†ã€‚å› æ­¤ï¼Œä»·æ ¼ï¼ˆç­‰äº $\sqrt{P}$ çš„å¹³æ–¹ï¼‰åœ¨èŒƒå›´ $[2^{-128}, 2^{128}]$ å†…ã€‚è€Œ ticks åœ¨ä»¥ä¸‹èŒƒå›´å†…ï¼š

$$[log_{1.0001}2^{-128}, log_{1.0001}{2^{128}}] = [-887272, 887272]$$

> è¦æ·±å…¥äº†è§£ Uniswap V3 çš„æ•°å­¦åŸç†ï¼Œæˆ‘å¼ºçƒˆæ¨è [Atis Elsts](https://twitter.com/atiselsts) çš„ [è¿™ä»½æŠ€æœ¯è¯´æ˜](https://atiselsts.github.io/pdfs/uniswap-v3-liquidity-math.pdf)ã€‚
